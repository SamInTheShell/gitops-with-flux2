---
apiVersion: source.toolkit.fluxcd.io/v1beta2
kind: HelmRepository
metadata:
  namespace: kubernetes-dashboard
  name: kubernetes-dashboard
spec:
  interval: 5m
  url: https://kubernetes.github.io/dashboard

---
apiVersion: helm.toolkit.fluxcd.io/v2beta1
kind: HelmRelease
metadata:
  namespace: kubernetes-dashboard
  name: kubernetes-dashboard
spec:
  chart:
    spec:
      chart: kubernetes-dashboard
      sourceRef:
        kind: HelmRepository
        name: kubernetes-dashboard
      version: ~7.13.0
  dependsOn: []
  interval: 5m
  releaseName: kubernetes-dashboard
  upgrade:
    remediation:
      remediateLastFailure: true
  values:
    ## Uncommand and configure for OIDC auth
    # web:
    #   containers:
    #     env:
    #       - name: DASHBOARD_LOGIN_MODE
    #         value: "OIDC"
    #       - name: OIDC_CLIENT_ID
    #         value: "<google-client-id>"
    #       - name: OIDC_CLIENT_SECRET
    #         value: "<google-client-secret>"
    #       - name: OIDC_ISSUER_URL
    #         value: "https://accounts.google.com"
    #       - name: OIDC_SCOPE
    #         value: "openid email profile"
    #       - name: OIDC_REDIRECT_URL
    #         value: "https://your-dashboard-url/oauth2/callback"